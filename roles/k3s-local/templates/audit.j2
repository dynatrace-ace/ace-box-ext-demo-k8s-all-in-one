apiVersion: audit.k8s.io/v1
kind: Policy
rules:
  # 7. Log service account access to secrets
  - level: RequestResponse
    verbs: ["get", "list"]
    resources:
      - group: ""
        resources: ["secrets"]

  # 8. Track service account pod execution
  - level: RequestResponse
    verbs: ["create"]
    resources:
      - group: ""
        resources: ["pods/exec", "pods/attach"]

  # 9. Monitor service account API calls
  - level: RequestResponse
    users: ["system:serviceaccount:*"]
